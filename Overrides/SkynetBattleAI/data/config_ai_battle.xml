<?xml version="1.0" encoding="utf-8"?>
<!-- ++EBII Battle AI Configuration++ -->
<!-- 11/5/2016 by z3n -->
<!-- <placement-offset>60</placement-offset> -->
<config>
    <deployment>
        <!-- <placement-offset>60</placement-offset> -->
        <settlements>
            <inside-gate-dist>5</inside-gate-dist>
            
            <units-per-wall>1</units-per-wall>
            
            <surprise-attack>
            	<!-- percentage of units to try and place on the walls of the settlement -->
            	<percent-on-walls>0.75</percent-on-walls>	
            	
            	<!-- percentage of units that are randomly scattered -->
            	<percent-scattered>0.0</percent-scattered>
            	
            	<!-- bias towards defenders -->
            	<defender-bias>0.10</defender-bias>
            	
            	<!-- controls the spread of the units along the wall as a percentage of unit width -->
            	<unit-spread>1.0</unit-spread>
            </surprise-attack>
            
            <expected-attack>
            	<!-- percentage of units to try and place on the walls of the settlement -->
            	<percent-on-walls>0.75</percent-on-walls>	
            	
            	<!-- percentage of units that are randomly scattered -->
            	<percent-scattered>0.0</percent-scattered>
            	
            	<!-- bias towards defenders -->
            	<defender-bias>0.10</defender-bias>
            	
            	<!-- controls the spread of the units along the wall as a percentage of unit width -->
            	<unit-spread>1.0</unit-spread>
            </expected-attack>
        </settlements>
    </deployment>

    <melee-manager>
		<prioritise-missile-attack>1</prioritise-missile-attack>
		<!-- multiplies the units charge value in the EDU, applies to an attack run (cavalry for example) and frequency/distance routers get chased -->
        <attack-dist-multiplier>10.0</attack-dist-multiplier>
		<missile>
        <attack-dist-multiplier>1.0</attack-dist-multiplier>
		</missile>
			<plan>
				<!-- amount of benefit the strength ratio yields -->
    			<strength-contribution>10.0</strength-contribution>
				<consider-missile>0</consider-missile>
				<consider-cavalry>0</consider-cavalry>
				<missile-cavalry>0</missile-cavalry>
				<merge-friendly-armies>1</merge-friendly-armies>
				<!-- planning the attack direction -->
				<attack-direction>
					<!-- amount of benefit the strength ratio yields -->
					<strength-contribution>10.0</strength-contribution>
					<front>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>1</phalanx>
						<missile>1</missile>
					</front>
					<right>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</right>
					<left>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</left>
					<rear>
						<cavalry>1</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</rear>
				</attack-direction>
			</plan>
			<support-armies>
				<approach-time>5</approach-time>
			</support-armies>
			<resourcing>
				<!-- backup priority -->
				<melee-infantry>10</melee-infantry>
				<cavalry>0</cavalry>
				    <unit-suitability>
    					<!-- all missile units -->
    					<missile>0</missile>
    					
    					<!-- all artillery units -->
    					<artillery>0</artillery>
    					
						<melee-infantry>10</melee-infantry>
    					
						<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>0</cavalry>
    					
						<elephant>10</elephant>
    				</unit-suitability>
					<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
					<threat-per-unit>25</threat-per-unit>
			</resourcing>
			<cavalry>
				<prioritise-outflanking>1</prioritise-outflanking>
			</cavalry>
			<missile>
				<prioritise-out-of-combat>1</prioritise-out-of-combat>
            </missile>

        <open>
		  <defend-terrain>
			<radius>1500</radius>
		  </defend-terrain>
		  
			<resourcing>
				<!-- backup priority -->
				<melee-infantry>10</melee-infantry>
				<cavalry>0</cavalry>
				    <unit-suitability>
    					<!-- all missile units -->
    					<missile>0</missile>
						
						<missile-infantry>0</missile-infantry>
						
    					<!-- all artillery units -->
    					<artillery>0</artillery>
    					
						<melee-infantry>10</melee-infantry>
    					
						<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>0</cavalry>
    					
						<elephant>10</elephant>
    				</unit-suitability>
					<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
					<threat-per-unit>25</threat-per-unit>
			</resourcing>
			<assignment>
				<melee-infantry-lockout-distance>6400</melee-infantry-lockout-distance>
				<missile-infantry-lockout-distance>6400</missile-infantry-lockout-distance>
				<cavalry-lockout-distance>6400</cavalry-lockout-distance>
			    <unit-suitability>
    				<!-- all missile units -->
    				<missile>0</missile>
					
					<missile-infantry>0</missile-infantry>
					
    				<!-- all artillery units -->
    				<artillery>0</artillery>
    				
					<melee-infantry>10</melee-infantry>
    				
					<!-- all cavalry units (elephants, horses etc) -->
    				<cavalry>0</cavalry>
    				
					<elephant>10</elephant>
    			</unit-suitability>
			</assignment>
			<infantry>
                <max-engage-dist>
                    <easy>150</easy>
                    <medium>150</medium>
                    <hard>150</hard>
                    <very_hard>150</very_hard>
                </max-engage-dist>
            </infantry>
            <missile>
                <max-engage-dist>
                    <easy>50</easy>
                    <medium>50</medium>
                    <hard>50</hard>
                    <very_hard>50</very_hard>
                </max-engage-dist>
            </missile>
            <cavalry>
                <max-engage-dist>
                    <easy>200</easy>
                    <medium>200</medium>
                    <hard>200</hard>
                    <very_hard>200</very_hard>
                </max-engage-dist>
            </cavalry>
			<general_unit>
                <max-engage-dist>
                    <easy>25</easy>
                    <medium>25</medium>
                    <hard>25</hard>
                    <very_hard>25</very_hard>
                </max-engage-dist>
            </general_unit>
        </open>
        
        <settlement>
            <infantry>
                <max-engage-dist>
                    <easy>100</easy>
                    <medium>100</medium>
                    <hard>100</hard>
                    <very_hard>100</very_hard>
                </max-engage-dist>
            </infantry>
            <missile>
                <max-engage-dist>
                    <easy>100</easy>
                    <medium>100</medium>
                    <hard>100</hard>
                    <very_hard>100</very_hard>
                </max-engage-dist>
            </missile>
            <cavalry>
                <max-engage-dist>
                    <easy>200</easy>
                    <medium>200</medium>
                    <hard>200</hard>
                    <very_hard>200</very_hard>
                </max-engage-dist>
            </cavalry>
            <general_unit>
                <max-engage-dist>
                    <easy>25</easy>
                    <medium>25</medium>
                    <hard>25</hard>
                    <very_hard>25</very_hard>
                </max-engage-dist>
            </general_unit>
        </settlement>
        
        <attack-brace>
            <distance>1000</distance>
            <time-to-change-formation>1.0</time-to-change-formation>
            <time-to-phalanx>1</time-to-phalanx>
            <time-to-schiltrom>1</time-to-schiltrom>
            <time-to-shield_wall>1</time-to-shield_wall>
        </attack-brace>
		
        <defend-brace>
            <distance>500</distance>
            <time-to-change-formation>3.0</time-to-change-formation>
            <time-to-phalanx>3</time-to-phalanx>
            <time-to-schiltrom>3</time-to-schiltrom>
            <time-to-shield_wall>3</time-to-shield_wall>
        </defend-brace>
        
		<retreat-analyser>
		
		<cavalry>
			<strength-ratio>1.1</strength-ratio>
		</cavalry>
		
		<retreat-counter>
			<easy>140</easy>
			<medium>160</medium>
			<hard>180</hard>
			<very_hard>200</very_hard>
		</retreat-counter>
		
		<!-- rally point -->
		<retreat-point>
			<default>
				<distance>100</distance>
			</default>
			<melee-infantry>
				<distance>0</distance>
			</melee-infantry>
			<phalanx>
				<distance>0</distance>
			</phalanx>
			
			<melee-infantry>
				<multiplier>0.0</multiplier>
			</melee-infantry>
			<cavalry>
				<multiplier>7.5</multiplier>
			</cavalry>
		
			<missile-infantry>
				<multiplier>1.25</multiplier>
			</missile-infantry>
		</retreat-point>
		</retreat-analyser>
        
        <outflank-analyser>
			<cavalry>
				<multiplier>7.5</multiplier>
			</cavalry>
        	<unit-priority>
        		<cavalry-vs-phalanx>100</cavalry-vs-phalanx>
        		<cavalry-vs-melee>100</cavalry-vs-melee>
        		<vs-cavalry>10</vs-cavalry>
        		<vs-routers>0.25</vs-routers>
				<vs-melee>5</vs-melee>
				<vs-missile>10</vs-missile>
				<vs-spearmen>25</vs-spearmen>
				<vs-artillery>15</vs-artillery>
        		<behind-stakes>30.0</behind-stakes>
        	</unit-priority>
			<unit-suitability>
				
				<!-- all cavalry units (elephants, horses etc) -->
				<cavalry>10</cavalry>
				
				<!-- all missile units -->
				<missile>8</missile>
				
				<!-- all melee infantry -->
				<melee-infantry>4</melee-infantry>						
    		
			</unit-suitability>
        </outflank-analyser>
		
		<melee-analyser>
		<!-- Adjusts how much importance is placed on the enemy unit's melee strength when deciding to attack -->
				<melee-strength-base-priority-modifier>0.0025</melee-strength-base-priority-modifier>
				<prioritise-missile-attack>1</prioritise-missile-attack>
				<prioritise-attack-direction>1</prioritise-attack-direction>
				<!-- forcing the attack direction -->
				<attack-direction>
					<!-- amount of benefit the strength ratio yields -->
					<strength-contribution>10.0</strength-contribution>
					<front>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>1</phalanx>
						<missile>1</missile>
					</front>
					<right>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</right>
					<left>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</left>
					<rear>
						<cavalry>1</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</rear>
				</attack-direction>
			<plan>
				<consider-missile>0</consider-missile>
				<consider-cavalry>0</consider-cavalry>
				<missile-cavalry>0</missile-cavalry>
			</plan>
			<open>
			<unit-priority>
			<cavalry-vs-cavalry>
				<priority>7500</priority>
			</cavalry-vs-cavalry>
			<cavalry-vs-missile>
				<priority>5000</priority>
			</cavalry-vs-missile>
			<cavalry-vs-spearmen>
				<priority>-5000</priority>
			</cavalry-vs-spearmen>
			<cavalry-vs-phalanx>
				<priority>-5000</priority>
			</cavalry-vs-phalanx>
			<cavalry-vs-melee>
				<priority>-5000</priority>
			</cavalry-vs-melee>
			</unit-priority>
			</open>
			<resourcing>
				<!-- backup priority -->
				<melee-infantry>20</melee-infantry>
				<cavalry>0</cavalry>
				    <unit-suitability>
    					<!-- all missile units -->
    					<missile>0</missile>
    					
    					<!-- all artillery units -->
    					<artillery>0</artillery>
    					
    					<!-- all melee units -->
    					<melee>1</melee>
						
						<melee-infantry>10</melee-infantry>
    					
						<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>0</cavalry>
    					
						<elephant>10</elephant>
    				</unit-suitability>
					<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
					<threat-per-unit>25</threat-per-unit>
			</resourcing>
			<cavalry>
				<prioritise-double-envelopment>2</prioritise-double-envelopment>
				<prioritise-outflanking>1</prioritise-outflanking>
				<prioritise-combat>0</prioritise-combat>
			</cavalry>
			<missile>
				<prioritise-out-of-combat>1</prioritise-out-of-combat>
            </missile>
		</melee-analyser>
		
		<tactics>
    			<melee-attack>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<melee-ratio>1.2</melee-ratio>
						<!-- amount of benefit the missile ratio yields -->
						<melee-contribution>20.0</melee-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
						<cavalry>0</cavalry>
						
						<melee-infantry>10</melee-infantry>

						<missile-infantry>4</missile-infantry>

    					
    				</unit-suitability>
				
    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					 <melee-suitability>
						 <!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)-->
						<cavalry>0</cavalry>
						
						<melee-infantry>10</melee-infantry>
						
						<missile-infantry>4</missile-infantry>
						
    				</melee-suitability>
    			</melee-attack> -->

    			<attack-melee>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<melee-ratio>1.2</melee-ratio>
						<!-- amount of benefit the missile ratio yields -->
						<melee-contribution>20.0</melee-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
						<cavalry>0</cavalry>
						
						<melee-infantry>10</melee-infantry>

						<missile-infantry>4</missile-infantry>

    					
    				</unit-suitability>
				
    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					 <melee-suitability>
						 <!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)-->
						<cavalry>0</cavalry>
						
						<melee-infantry>10</melee-infantry>
						
						<missile-infantry>4</missile-infantry>
						
    				</melee-suitability>
    			</attack-melee>

    			<missile-attack>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<missile-ratio>0</missile-ratio>
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the missile ratio yields -->
						<missile-contribution>0</missile-contribution>
						<cavalry-contribution>20.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
						<cavalry>8</cavalry>
						
						<missile>0</missile>
						
						<melee-infantry>0</melee-infantry>
    					
    				</unit-suitability>
				
    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<missile-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line) -->
						
						<cavalry>8</cavalry>
						
						<missile>0</missile>
						
						<melee-infantry>0</melee-infantry>
					
    				</missile-suitability>
    			</missile-attack>

    			<attack-missile>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<missile-ratio>0</missile-ratio>
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the missile ratio yields -->
						<missile-contribution>0</missile-contribution>
						<cavalry-contribution>20.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
						<cavalry>8</cavalry>
						
						<missile>0</missile>
						
						<melee-infantry>0</melee-infantry>
    					
    				</unit-suitability>
				
    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<missile-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line) -->
						<cavalry>8</cavalry>
						
						<missile>0</missile>
						
						<melee-infantry>0</melee-infantry>
					
    				</missile-suitability>
    			</attack-missile>

    			<double-envelopment-attack>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the cavalry ratio yields -->
						<cavalry-contribution>80.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>10</cavalry>
						
    					<!-- all missile units -->
    					<missile>8</missile>
						
						<!-- all melee infantry -->
						<melee-infantry>4</melee-infantry>						
    					
    				</unit-suitability>

    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- head for this offset from the enemy -->
    				<enemy-offset>100.0</enemy-offset>			
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<double-envelopment-attack-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)< -->
						<cavalry>10</cavalry>
						
						<missile>8</missile>
						
						<melee-infantry>4</melee-infantry>
					
    				</double-envelopment-attack-suitability>
    			</double-envelopment-attack>

    			<double-envelopment-outflanking>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the cavalry ratio yields -->
						<cavalry-contribution>80.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>10</cavalry>
						
    					<!-- all missile units -->
    					<missile>8</missile>
						
						<!-- all melee infantry -->
						<melee-infantry>4</melee-infantry>
    					
    				</unit-suitability>
    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- head for this offset from the enemy -->
    				<enemy-offset>100.0</enemy-offset>			
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<double-envelopment-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)< -->
						<cavalry>10</cavalry>
						
						<missile>8</missile>
						
						<melee-infantry>4</melee-infantry>
					
    				</double-envelopment-suitability>
    			</double-envelopment-outflanking>
				
    			<outflanking-attack>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the cavalry ratio yields -->
						<cavalry-contribution>20.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>10</cavalry>
						
    					<!-- all missile units -->
    					<missile>8</missile>
						
						<!-- all melee infantry -->
						<melee-infantry>4</melee-infantry>						
    					
    				</unit-suitability>

    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- head for this offset from the enemy -->
    				<enemy-offset>100.0</enemy-offset>			
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<outflanking-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)< -->
						<cavalry>10</cavalry>
						
						<missile>8</missile>
						
						<melee-infantry>4</melee-infantry>
					
    				</outflanking-suitability>
    			</outflanking-attack>

    			<attack-outflanking>
					<resourcing>
        				<!-- maximum number of units that can be assigned -->
						<cavalry-ratio>1.2</cavalry-ratio>
						<!-- amount of benefit the cavalry ratio yields -->
						<cavalry-contribution>20.0</cavalry-contribution>
						<stall-limit>100</stall-limit>
					</resourcing>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
					
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>10</cavalry>
						
    					<!-- all missile units -->
    					<missile>8</missile>
						
						<!-- all melee infantry -->
						<melee-infantry>4</melee-infantry>
    					
    				</unit-suitability>

    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>400000</run-threshold>
    				
    				<!-- head for this offset from the enemy -->
    				<enemy-offset>100.0</enemy-offset>			
    				
    				<!-- parameters for determining the suitability of an outflanking attack -->
					<outflanking-suitability>
						<!-- unit suitability values (cavalry and missile flank before melee infantry, which must first hold the attacking or defensive line)< -->
						<cavalry>10</cavalry>
						
						<missile>8</missile>
						
						<melee-infantry>4</melee-infantry>
					
    				</outflanking-suitability>
    			</attack-outflanking>

		</tactics>		
		
		</melee-manager>
    
    <missile-analyser>
		<!-- Adjusts how much importance is placed on the enemy unit's missile strength when deciding to shoot at them -->
		<missile-strength-base-priority-modifier>0.0025</missile-strength-base-priority-modifier>
		<missile-attack-priority-modifier>10.0</missile-attack-priority-modifier>
		<melee-attack-priority-modifier>0.0</melee-attack-priority-modifier>
		<missile>
			<prioritise-out-of-combat>1</prioritise-out-of-combat>
        </missile>
		
		<cavalry>
			<prioritise-out-of-combat>1</prioritise-out-of-combat>
		</cavalry>
		
    	<unit-suitability>
			
    		<!-- all cavalry units (elephants, horses etc) -->
			<missile>10</missile>
			
			<cavalry>8</cavalry>
			
			<melee-infantry>0</melee-infantry>
			
    	</unit-suitability>
		
    </missile-analyser>

    <gta>
        <assault-dist>30.0</assault-dist>
        <contact-dist>60.0</contact-dist>
        <close-approach-dist>120.0</close-approach-dist>
        <distant-approach-dist>240.0</distant-approach-dist>
        <enemy-far-dist>450.0</enemy-far-dist>
        <enemy-near-dist>90.0</enemy-near-dist>

        <unit-group-merge-dist>999999.0</unit-group-merge-dist>
        <unit-group-speed-tolerance>0.25</unit-group-speed-tolerance>
        <unit-group-strength-tolerance>999999</unit-group-strength-tolerance>

        <!-- merge own units with a greater tolerance -->
        <local-group-merge-dist>999999.0</local-group-merge-dist>
                
        <common-tactics>
                <!-- engage state - will hold position and fight the enemy -->
                <engage>
					<!-- used to prevent infantry disengaging without a clear objective -->
					<priority>50000</priority>
		            <state-criteria>
						<infantry>
							<!-- engage if the percentage of soldiers in the unit in combat is above this -->
							<combat-percentage>0.01</combat-percentage>
								
                			<!-- engage if the enemy is within this distance - in metres squared -->
                			<nearest-enemy>500.0</nearest-enemy>
						</infantry>
	                </state-criteria>
                </engage>
                <outflanking>
					<cavalry>
						<!-- outflank if the enemy is within this distance - in metres squared -->
						<nearest-enemy>1000.0</nearest-enemy>
						<!-- run if closer than this distance (in metres squared) -->
						<run-threshold>1200000</run-threshold>
					</cavalry>
                </outflanking>
				<cavalry>
					<!-- percentage of troops killed in 4 seconds by missile units to cause Ai to pull back -->
					<melee-death-threshold>0.01</melee-death-threshold>
				</cavalry>
			<move-to-point>
        		<!-- switch to idle hint if within this distance of the target -->
				<open>
					<direction>
						<front>
							<proximity>
								
								<default>5.0</default>
								
								<infantry>10.0</infantry>
								
								<cavalry>10.0</cavalry>
							</proximity>
						</front>
						<right>
							<proximity>
								
								<default>500.0</default>
								
								<infantry>500.0</infantry>
								
								<cavalry>1500.0</cavalry>
							</proximity>
						</right>
						<left>
							<proximity>
								
								<default>500.0</default>
								
								<infantry>500.0</infantry>
								
								<cavalry>1500.0</cavalry>
							</proximity>
						</left>
						<rear>
							<proximity>
								
								<default>500.0</default>
								
								<infantry>750.0</infantry>
								
								<cavalry>1500.0</cavalry>
							</proximity>
						</rear>
					</direction>
				</open>
				
				<settlement>
					<!-- switch to idle hint if within this distance of the target -->
					
					<proximity>5000.0</proximity>
					
				</settlement>
				
        	</move-to-point>
        </common-tactics>
        
    	<!-- The outflanking subset plan during battle -->
        <outflanking>
			<run-threshold>120000</run-threshold>
            <tracking-tolerance>125.0</tracking-tolerance>
			<stall-limit>10</stall-limit>
			<cavalry-ratio>1.2</cavalry-ratio>
    		<cavalry-contribution>20.0</cavalry-contribution>
    		
			<unit-suitability>
				
    			<!-- all cavalry units (elephants, horses etc) -->
				<cavalry>10</cavalry>
				
    			<!-- all missile units -->
				<missile>8</missile>
				
    			<!-- all melee infantry -->
				<melee-infantry>4</melee-infantry>
				
    		</unit-suitability>
			
			<open>
			
				<cavalry>
					<priority>75000</priority>
				</cavalry>
				
				<melee-infantry>
					<priority>0</priority>
				</melee-infantry>

			</open>
			
            <double-envelopment>
			<stall-limit>10</stall-limit>
            <tracking-tolerance>125.0</tracking-tolerance>
    		<cavalry-contribution>40.0</cavalry-contribution>
			<cavalry-ratio>1.2</cavalry-ratio>
    		<unit-suitability>
				
    			<!-- all cavalry units (elephants, horses etc) -->
				<cavalry>10</cavalry>
				
    			<!-- all missile units -->
				<missile>8</missile>
				
    			<!-- all melee infantry -->
				<melee-infantry>4</melee-infantry>
				
    		</unit-suitability>
			
			<open>
			
				<cavalry>
					<priority>100000</priority>
				</cavalry>
				
				<melee-infantry>
					<priority>0</priority>
				</melee-infantry>
			</open>
			
            </double-envelopment>
        </outflanking>

    	<!-- The ambush subset plan during battle -->
        <ambush>
            <plan>
                <!-- consider or not missile units for hiding (1/0) -->
                <consider-missile>0</consider-missile>
                <!-- consider up to the specified percentage of the force for hiding -->
                <consider-max-force>0</consider-max-force>
                <!-- time it should take hidden units to approach the fight (seconds) -->
                <approach-time>0</approach-time>
                <!-- deployment search increment (metres) -->
                <deployment-search-inc>6</deployment-search-inc>
				<open>
				<!-- amount of benefit the strength ratio yields -->
    			<strength-contribution>10.0</strength-contribution>
				<consider-missile>0</consider-missile>
				<consider-cavalry>0</consider-cavalry>
				<missile-cavalry>0</missile-cavalry>
				<merge-friendly-armies>1</merge-friendly-armies>
				<!-- planning the attack direction -->
				<attack-direction>
					<!-- amount of benefit the strength ratio yields -->
					<strength-contribution>10.0</strength-contribution>
					<front>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>1</phalanx>
						<missile>1</missile>
					</front>
					<right>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</right>
					<left>
						<cavalry>0</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</left>
					<rear>
						<cavalry>1</cavalry>
						<melee>1</melee>
						<spearmen>1</spearmen>
						<phalanx>0</phalanx>
						<missile>1</missile>
					</rear>
				</attack-direction>
				</open>
            </plan>
        </ambush>

    	<!-- The reinforcement subset plan during battle -->
		<support-armies>
			<plan>
				<merge-friendly-armies>1</merge-friendly-armies>
				<!-- consider up to the specified percentage of the force for reform -->
				<consider-max-force>100</consider-max-force>
				<!-- time it should take support units to approach the fight (seconds) -->
				<approach-time>5</approach-time>
			</plan>
			<run-threshold>300000</run-threshold>
            <reform-dist>0</reform-dist>
		</support-armies>

        <attack-settlement>
            <detachment>
            	<engine-collection>
            		<!-- when stealing an engine, prioritise being out of combat over distance -->
            		<prioritise-out-of-combat>1</prioritise-out-of-combat>
            	</engine-collection>
            	<commit>
            		<!-- commit sufficient forces to outnumber the enemy by this ratio -->
            		<strength-ratio>0</strength-ratio>
            	</commit>
            	<perimeter-attack>
            		<termination-criteria>
            			<enemy-in-perimeter>0.25</enemy-in-perimeter>
            		</termination-criteria>
            	</perimeter-attack>
                <max-plaza-assault-groups>5</max-plaza-assault-groups>
                <units-per-plaza-assault-group>4</units-per-plaza-assault-group>
				<street-position>
        			<!-- base threat level possessed by street positions - used to enforce an attacking spread of units -->
        			<base-threat>100.0</base-threat>
        		</street-position>
                <artillery-times>
                	<!-- successful assaults performed for at least 1 minute -->
                	<minimum>1.0</minimum>
                	
                	<!-- don't prolong the bombardment longer than 6 minutes if we have no targets left -->
                	<maximum>6.0</maximum>
                	
                	<!-- stall test is a moving average that checks if any artillery is active (moving/firing/reloading) each tick -->
                	<stall-test>
                		<!-- minimum number of ticks to collect before detecting a stall -->
                		<minimum-samples>900</minimum-samples>
                		
                		<!-- track at most this number of samples -->
                		<maximum-samples>1200</maximum-samples>
                		
	                	<!-- if the artillery has be inactive for at least 75% of its time -->
                		<limit>0.5</limit>
                	</stall-test>
                </artillery-times>
            </detachment>
            <tactics>
                <assault-gate>
                    <inside-position-dist>25</inside-position-dist>
                    <formation>ai_settlement_assault_gate</formation>
                </assault-gate>
                <reform>
                    <offset>30</offset>
                    <formation>ai_settlement_attack_reform</formation>
                    <percentage-formed>10</percentage-formed>
                    <advance-timer>1.0</advance-timer>
                    <siege-equipment-advance-timer>5.0</siege-equipment-advance-timer>
                </reform>
                <capture-plaza>
                    <reform-dist>120</reform-dist>
                </capture-plaza>
				
				<assault-walls>
				<assignment>
					<!-- attack the top x surfaces. sorted by descending assault threat -->
					<points>4</points>
					<surfaces>4</surfaces>
					
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>20</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>25</threat-per-unit>
        			</resourcing>

        		</assignment>

				
        		<street-position>
        			<!-- base threat level possessed by street positions - used to enforce an initial spread of units -->
        			<base-threat>125.0</base-threat>
        		</street-position>

				
					<ladder>
					
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>20</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>25</threat-per-unit>
        			</resourcing>
					
					<phases>
    					<!-- phase 1 - running with the ladder to the walls -->
    					<phase1>
						
    						<!-- configuring the conditions for entering this phase -->    						
    						<entry-conditions>
    							<!-- ratio of current to initial melee strength -->
    							<melee-remaining>1.0</melee-remaining>

    							<!-- outshoot ratio between enemy and us. Test: [enemy strength] > [ally strength] * [ratio] -->
    							<outshoot-ratio>1.4</outshoot-ratio>
    						</entry-conditions>
						
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
						</phase1>
						
    					<!-- phase 2 - in case of artillery or heavy fire -->
    					<phase2>
						
    						<!-- configuring the conditions for entering this phase -->    						
    						<entry-conditions>
    							<!-- ratio of current to initial melee strength -->
    							<melee-remaining>0.75</melee-remaining>

    							<!-- outshoot ratio between enemy and us. Test: [enemy strength] > [ally strength] * [ratio] -->
    							<outshoot-ratio>1.1</outshoot-ratio>
    						</entry-conditions>
						
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
						</phase2>
					</phases>
					</ladder>
					
					<tower>

        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>20</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>25</threat-per-unit>
        			</resourcing>
					
					</tower>
					
        		</assault-walls>
               		
        		<!-- plaza attack -->
        		<attack-plaza>
        			<!-- only issue move orders if we are more than this distance away from the destination -->
        			<destination-proximity>2700.0</destination-proximity>
        		</attack-plaza>
        		
        		<!-- street attack to work in conjunction with street threat  -->
        		<attack-street>
        			<!-- configure resourcing strategy for this tactic -->
        			<resourcing>
        				<!-- priority to encourage attacks from another street -->
						<prioritise-outflanking>1</prioritise-outflanking>
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>35</threat-per-unit>
        			</resourcing>
        			
        		</attack-street>
            </tactics>
        </attack-settlement>

        <attack-battlegroup>
            <tracking-tolerance>125.0</tracking-tolerance>
            <formed-percentage>20</formed-percentage>
            <formed-percentage-finished>66</formed-percentage-finished>
            <shootout-distance-tolerance>75</shootout-distance-tolerance>
			<prioritise-merge-support-armies>1</prioritise-merge-support-armies>

        <attack-hill>
			<tactics>
				<assault>
    				<!-- minimum number of melee units for this task -->
    				<melee-ratio>1.2</melee-ratio>
    				
    				<!-- tick limit on being stalled -->
    				<stall-limit>100</stall-limit>
    				
    				<!-- per phase configuration -->
    				<phases>
    					<!-- phase 1 - running up the hill -->
    					<phase1>
						
    						<!-- configuring the conditions for entering this phase -->    						
    						<entry-conditions>
    							<!-- ratio of current to initial melee strength -->
    							<melee-remaining>0.9</melee-remaining>

    							<!-- outshoot ratio between enemy and us. Test: [enemy strength] > [ally strength] * [ratio] -->
    							<outshoot-ratio>1.4</outshoot-ratio>
    						</entry-conditions>
						
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
						</phase1>

    					<!-- phase 2 - in case of artillery -->
    					<phase2>
						
    						<!-- configuring the conditions for entering this phase -->    						
    						<entry-conditions>
    							<!-- ratio of current to initial melee strength -->
    							<melee-remaining>0.75</melee-remaining>

    							<!-- outshoot ratio between enemy and us. Test: [enemy strength] > [ally strength] * [ratio] -->
    							<outshoot-ratio>1.1</outshoot-ratio>
    						</entry-conditions>
						
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
						</phase2>

						</phases>
						</assault>
			</tactics>
            <plan>
                <!-- time it should take units to approach the fight (seconds) -->
                <approach-time>15</approach-time>
				<!-- prioritize outflanking the enemy -->
				<prioritise-outflanking>1</prioritise-outflanking>
                <!-- deployment search increment (metres) -->
                <deployment-search-inc>6</deployment-search-inc>
            </plan>
        </attack-hill>

            <fight>
			<open>
				<missile>
                	<minimum>2.0</minimum>
                	
                	<!-- don't prolong the bombardment longer than 6 minutes if we have no targets left -->
                	<maximum>6.0</maximum>
				</missile>
				<cavalry>
                	<minimum>2.0</minimum>
                	
                	<!-- don't prolong the bombardment longer than 6 minutes if we have no targets left -->
                	<maximum>6.0</maximum>
				</cavalry>
            </open>
				<!-- do not enter fight if the enemy missile strength is greater than this ratio times our missile strength -->
            	<missile-ratio>999.0</missile-ratio>
            </fight>
            <formation>
                <easy>ai_triple_missiles_in_front</easy>
                <medium>ai_triple_missiles_in_front</medium>
                <hard>ai_triple_missiles_in_front</hard>
                <very_hard>ai_triple_missiles_in_front</very_hard>
            </formation>
        </attack-battlegroup>

        <defend-line>
            <tracking-tolerance>125.0</tracking-tolerance>
            <formed-percentage>20.0</formed-percentage>
			
		    <defend-terrain>
				<radius>1500</radius>
		    </defend-terrain>

        	<threat-assessment>
        		<unit>
    				<!-- default threat contribution -->
    				<contribution-general>20</contribution-general>
    				
    				<!-- threat contribution when attacker is moving towards unit -->
    				<contribution-targetted>30</contribution-targetted>
    				
    				<!-- rate at which the threat fades per metre (flankers) -->
    				<horizontal-fade>0.025</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for hills) -->
    				<vertical-fade>0.05</vertical-fade>
    				
    				<!-- rate at which threat fades per metre (from the battleline) -->
    				<general-fade>0.1</general-fade>
				</unit>
        	</threat-assessment>

		    <stage-configuration>
				<assignment>
					<!-- if the assault threat goes over this threshold then melee units will be assigned -->
					<melee-threshold>0</melee-threshold>
				</assignment>	       
		    </stage-configuration>

			<tactics>
				
			<defend-terrain>
				<radius>1500</radius>
				<max-defend-distance>1000</max-defend-distance>
        		<resourcing>
					<!-- maximum number of units that can be assigned -->
					<max-units>40</max-units>
        			
					<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        			<threat-per-unit>25</threat-per-unit>
        		</resourcing>
			</defend-terrain>
			
			<defend-hill>
				<stage-configuration>
					<assignment>
						<!-- if the assault threat goes over this threshold then melee units will be assigned -->
						<melee-threshold>5</melee-threshold>
					</assignment>	       
				</stage-configuration>
        		<resourcing>
        			<!-- maximum number of units that can be assigned -->
        			<max-units>40</max-units>
        			
        			<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        			<threat-per-unit>50</threat-per-unit>
        		</resourcing>
			</defend-hill>
        	</tactics>
        </defend-line>
        
        <!-- defending against a sally out -->
        <defend-sally-out>
            <tracking-tolerance>125.0</tracking-tolerance>
        	<!-- reform to this amount times the tower range -->
        	<tower-range-scale>3.0</tower-range-scale>
        	<!-- plus this set value -->
        	<tower-range-buffer>300.0</tower-range-buffer>
			<defend-terrain>
				<radius>1500</radius>
			</defend-terrain>
			
	        <threat-assessment>
        		<unit>
    				<!-- default threat contribution -->
    				<contribution-general>20</contribution-general>
    				
    				<!-- threat contribution when attacker is moving towards unit -->
    				<contribution-targetted>30</contribution-targetted>
    				
    				<!-- rate at which the threat fades per metre (flankers) -->
    				<horizontal-fade>0.025</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for hills) -->
    				<vertical-fade>0.05</vertical-fade>
    				
    				<!-- rate at which threat fades per metre (from the battleline) -->
    				<general-fade>0.1</general-fade>
				</unit>
        	</threat-assessment>

		    <stage-configuration>
				<assignment>
					<!-- if the assault threat goes over this threshold then melee units will be assigned -->
					<melee-threshold>0</melee-threshold>
				</assignment>	       
		    </stage-configuration>

			<tactics>
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>40</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>25</threat-per-unit>
        			</resourcing>
				
				    <defend-terrain>
						<radius>1500</radius>
						<max-defend-distance>1000</max-defend-distance>
					</defend-terrain>
        	</tactics>
			
			<defend-hill>
				<stage-configuration>
					<assignment>
						<!-- if the assault threat goes over this threshold then melee units will be assigned -->
						<melee-threshold>5</melee-threshold>
					</assignment>	       
				</stage-configuration>
				<tactics>
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>40</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>50</threat-per-unit>
        			</resourcing>
				</tactics>
			</defend-hill>
        </defend-sally-out>
        
        <sally-out>
        	<!-- distance from the settlement to rally before initial attack -->
        	<rally-distance>50.0</rally-distance>
        	
        	<!-- interval to repeat the sally out order at (in 1/10ths of a second) -->
        	<order-repeat-rate>300</order-repeat-rate>
					<entry-conditions>
						<!-- have our forces depleted enough from missile fire? -->
						<loss-ratio>0.05</loss-ratio>
						<!-- percentage of troops killed in 4 seconds by missile units to cause AI to sally -->
						<missile-death-threshold>0.01</missile-death-threshold>
					</entry-conditions>
					
					<!-- which settlements is this state permitted for -->
        			<permitted-settlements>
        				<!-- forts -->
        				<fort>1</fort>
        				
        				<!-- castles -->
        				<motte_and_bailey>1</motte_and_bailey>
        				<wooden_castle>1</wooden_castle>
        				<castle>1</castle>
        				<fortress>1</fortress>
        				<citadel>1</citadel>
        				
        				<!-- cities -->
        				<village>1</village>
        				<town>0</town>
        				<large_town>0</large_town>
        				<city>0</city>
        				<large_city>0</large_city>
        				<huge_city>0</huge_city>
        			</permitted-settlements>

        </sally-out>
        
        <!-- defend settlement objective -->
        <defend-settlement>
        	<threat-assessment>
        		<!-- how far behind the siege equipment does the threat extend -->
        		<lag-distance>-200.0</lag-distance>
        		
        		<!-- how far in front of the siege equipment does the threat extend -->
        		<lead-distance>200.0</lead-distance>
        		
        		<!-- what angle (either side of target vector) is considered at risk -->
        		<risk-angle>0.95</risk-angle>
        		
        		<!-- what distance away (normal distance) is considered irrelevant -->
        		<approach-threshold>300</approach-threshold>
        		
        		<breach>
        			<!-- threat contribution when the breachable area is damaged -->
        			<contribution-damaged>20</contribution-damaged>
        			
        			<!-- amount of breach threat that gets applied as an assault threat -->
        			<bleed-over>0.1</bleed-over>
        		</breach>
        		
        		<gate>
        			<!-- base threat level possessed by breaches - enforces an initial unit spread -->
        			<base-threat>0.0</base-threat>
        		</gate>
        		
        		<street-position>
        			<!-- base threat level possessed by street positions - used to enforce an initial spread of units -->
        			<base-threat>6.0</base-threat>
        		</street-position>
        		
        		<weak-point>
        			<!-- threat contribution from unit proximity -->
        			<contribution-units>10</contribution-units>
        			
        			<!-- distance (in metres squared) above which a unit does not contribute -->
        			<unit-threshold>10000</unit-threshold>
        		</weak-point>
        		
        		<tower>
    				<!-- default threat contribution -->
    				<contribution-general>40</contribution-general>
    				
    				<!-- threat contribution when siege equipment is moving this way -->
    				<contribution-targetted>30</contribution-targetted>
    				
    				<!-- threat contribution when the siege equipment is docked -->
    				<contribution-docked>30</contribution-docked>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<horizontal-fade>0.25</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<vertical-fade>0.075</vertical-fade>
        		</tower>
        		
        		<ladder>
    				<!-- default threat contribution -->
    				<contribution-general>40</contribution-general>
    				
    				<!-- threat contribution when siege equipment is moving this way -->
    				<contribution-targetted>30</contribution-targetted>
    				
    				<!-- threat contribution when the siege equipment is docked -->
    				<contribution-docked>30</contribution-docked>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<horizontal-fade>0.25</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<vertical-fade>0.075</vertical-fade>
        		</ladder>
        		
        		<ram>
    				<!-- default threat contribution -->
    				<contribution-general>40</contribution-general>
    				
    				<!-- threat contribution when siege equipment is moving this way -->
    				<contribution-targetted>30</contribution-targetted>
    				
    				<!-- threat contribution when the siege equipment is docked -->
    				<contribution-docked>30</contribution-docked>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<horizontal-fade>0.25</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<vertical-fade>0.075</vertical-fade>
        		</ram>
        		
        		<unit>
    				<!-- default threat contribution -->
    				<contribution-general>20</contribution-general>
    				
    				<!-- threat contribution when siege equipment is moving this way -->
    				<contribution-targetted>20</contribution-targetted>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<horizontal-fade>0.2</horizontal-fade>
    				
    				<!-- rate at which the threat fades per metre (for weakpoints and breaches) -->
    				<vertical-fade>0.10</vertical-fade>
    				
    				<!-- rate at which threat fades per metre (for street defenses) -->
    				<general-fade>0.2</general-fade>
    				
    				<!-- scale factor applied to the plaza threat -->
    				<plaza-scale>1.1</plaza-scale>
        		</unit>
        		
        		<!-- if our force strength is this value times the attacker's strength then sally out -->
        		<sally-out-ratio>2.0</sally-out-ratio>
        	</threat-assessment>
        	
        	<!-- settlement defense stage control -->
        	<stage-configuration>
        		<!-- in this stage the walls are defended and towers are manned. the objective is to repel the attackers as strongly as possible -->
        		<repel-attackers>
        			<!-- criteria for moving to the next stage -->
        			<progression-criteria>
        				<!-- percentage of the enemy force that has made it inside (on ground or walls) -->
        				<enemy-penetration>0.75</enemy-penetration>
        				
        				<!-- percentage of breaches we can tolerate - set to 0 to tolerate no breaches * means they all pull back immediately upon gate breach -->
        				<breach-threshold>90.0</breach-threshold>
	        			
	        			<!-- is the plaza threat over this level -->
	        			<plaza-threat>9999.0</plaza-threat>
        			</progression-criteria>
        			
        			<!-- configuration for how units are assigned in this stage -->
        			<assignment>
        				<!-- defend the top x surfaces. sorted by descending assault threat -->
        				<surfaces>8</surfaces>
        				
        				<!-- defend the top x breach points. sorted by descending breach threat -->
        				<breaches>4</breaches>
        				
        				<!-- don't assign units to a surface if its health is below this limit -->
        				<surface-health>0.70</surface-health>
        				
        				<!-- threat values below this limit will be ignored -->
        				<minimum-threat>5</minimum-threat>
        				
        				<!-- if the assault threat goes over this threshold then melee units will be assigned -->
        				<melee-threshold>70</melee-threshold>
        				
        				<!-- allow stealing if (new tactic threat / old tactic threat) is this greater than this ratio -->
        				<tactic-switch-limit>1.3</tactic-switch-limit>
        				
        				<!-- if a unit is assigned to a defend a breach within this distance (in metres squared) then don't assign a unit -->
        				<breach-lockout-distance>6400</breach-lockout-distance>
        			</assignment>
        		</repel-attackers>
        		
        		<!-- in this stage we are still manning walls and towers but we now also defend breaches -->
        		<defend-perimeter>
        			<!-- criteria for moving to the next stage -->
        			<progression-criteria>
        				<!-- defines how many troops are required to defend against different incursion types -->
        				<manning-requirements>
        					<!-- destroyed wall, gate or spy unlocked gate -->
        					<ground-incursion>
        						<siege-engine>0</siege-engine>
        						<cavalry>1</cavalry>
        						<melee-infantry>2</melee-infantry>
        						<missile-infantry>0</missile-infantry>
        					</ground-incursion>
        					
        					<!-- docked ladder/tower -->
        					<wall-incursion>
        						<siege-engine>0</siege-engine>
        						<cavalry>0</cavalry>
        						<melee-infantry>1</melee-infantry>
        						<missile-infantry>1</missile-infantry>
        					</wall-incursion>
        				</manning-requirements>
        				
        				<!-- enemy got 100% of their force into the settlement -->
        				<enemy-penetration>1.0</enemy-penetration>
	        			
	        			<!-- is the plaza threat over this level -->
	        			<plaza-threat>9999.0</plaza-threat>
        			</progression-criteria>
        			
        			<!-- configuration for how units are assigned in this stage -->
        			<assignment>
        				<!-- defend the top x surfaces. sorted by descending assault threat -->
        				<surfaces>8</surfaces>
        				
        				<!-- defend the top x breach points. sorted by descending breach threat -->
        				<breaches>4</breaches>
        				
        				<!-- don't assign units to a surface if its health is below this limit -->
        				<surface-health>0.70</surface-health>
        				
        				<!-- threat values below this limit will be ignored -->
        				<minimum-threat>5</minimum-threat>
        				
        				<!-- if the assault threat goes over this threshold then melee units will be assigned -->
        				<melee-threshold>70</melee-threshold>
        				
        				<!-- allow stealing if (new tactic threat / old tactic threat) is this greater than this ratio -->
        				<tactic-switch-limit>1.3</tactic-switch-limit>
        				
        				<!-- if a unit is assigned to a defend a breach within this distance (in metres squared) then don't assign a unit -->
        				<breach-lockout-distance>6400</breach-lockout-distance>
        			</assignment>
        		</defend-perimeter>
        		
        		<!-- in this stage we are fighting on the ground and trying to hold the enemy back -->
        		<defend-streets>
        			<!-- criteria for moving to the next stage -->
        			<progression-criteria>
	        			<!-- if the enemy outnumbers us by this proportion (in the perimeter) then fall back -->
	        			<force-ratio>999.0</force-ratio>
	        			
	        			<!-- have our forces depleted too much in this stage? -->
	        			<loss-ratio>0.9</loss-ratio>
	        			
	        			<!-- is the plaza threat over this level -->
	        			<plaza-threat>9999.0</plaza-threat>
        			</progression-criteria>
        			
        			<!-- which settlements is this state permitted for -->
        			<permitted-settlements>
        				<!-- forts -->
        				<fort>1</fort>
        				
        				<!-- castles -->
        				<motte_and_bailey>1</motte_and_bailey>
        				<wooden_castle>1</wooden_castle>
        				<castle>1</castle>
        				<fortress>1</fortress>
        				<citadel>1</citadel>
        				
        				<!-- cities -->
        				<village>1</village>
        				<town>1</town>
        				<large_town>1</large_town>
        				<city>1</city>
        				<large_city>1</large_city>
        				<huge_city>1</huge_city>
        			</permitted-settlements>
        			
        			<!-- configuration for how units are assigned in this stage -->
        			<assignment>
        				<!-- defend the top x defense points. sorted by descending threat -->
        				<maximum-points>8</maximum-points>
        				
        				<!-- threat values below this limit will be ignored -->
        				<minimum-threat>5</minimum-threat>
        				
        				<!-- allow stealing if (new tactic threat / old tactic threat) is this greater than this ratio -->
        				<tactic-switch-limit>1.3</tactic-switch-limit>
        			</assignment>
        		</defend-streets>
        		
        		<pull-back>
        			<!-- criteria for moving to the next stage -->
        			<progression-criteria>
	        			<!-- if the enemy outnumbers us by this proportion (in the perimeter) then fall back -->
	        			<maximum-proportion>999.0</maximum-proportion>
	        			
	        			<!-- is the plaza threat over this level -->
	        			<plaza-threat>9999.0</plaza-threat>
	        			
	        			<!-- are all units pulling back within this distance of their destination? (in metres squared) -->
	        			<destination-proximity>250.0</destination-proximity>
        			</progression-criteria>
        		</pull-back>
        	</stage-configuration>
        
        	<!-- per tactic configuration -->
        	<tactics>
        		<!-- surplus tactic -->
        		<surplus>
        			<gate-offset>100.0</gate-offset>
        		</surplus>
        		
        		<!-- wall defense tactic -->
        		<defend-walls>
        			<!-- configure resourcing strategy for this tactic -->
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>20</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>35</threat-per-unit>
        			</resourcing>
        			
        			<!-- only issue move orders if we are more than this distance away from the destination -->
        			<destination-proximity>250.0</destination-proximity>
        		</defend-walls>
        		
        		<!-- defense manning tactic -->
        		<man-defense>
        		</man-defense>
        		
        		<!-- plaza defense -->
        		<defend-plaza>
        			<!-- only issue move orders if we are more than this distance away from the destination -->
            		<prioritise-out-of-combat>1</prioritise-out-of-combat>
        			<destination-proximity>3500.0</destination-proximity>
				</defend-plaza>
        		
        		<!-- street defense -->
        		<defend-street>
        			<!-- configure resourcing strategy for this tactic -->
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>20</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>20</threat-per-unit>
        			</resourcing>
        			
        			<!-- only issue move orders if we are more than this distance away from the destination -->
        			<destination-proximity>750.0</destination-proximity>
        		</defend-street>
        		
        		<!-- breach defense -->
                <defend-breaches>
                	<!-- if the gate health drops below this percentage then the breach should be defended -->
                    <gate-health-perc>0.75</gate-health-perc>

                	<!-- if the wall health drops below this percentage then the breach should be defended -->
                    <wall-health-perc>0.75</wall-health-perc>
                    
                    <!-- unit offset in metres from the breach -->
                    <breach-offset-pos>10</breach-offset-pos>
                    
                    <!-- lateral offset -->
                    <lateral-offset>10.0</lateral-offset>
                    
        			<!-- configure resourcing strategy for this tactic -->
        			<resourcing>
        				<!-- maximum number of units that can be assigned -->
        				<max-units>4</max-units>
        				
        				<!-- amount of threat a single unit can counter (controls how many units will get assigned) -->
        				<threat-per-unit>30</threat-per-unit>
        			</resourcing>
         			
        			<!-- only issue move orders if we are more than this distance away from the destination -->
        			<destination-proximity>250.0</destination-proximity>
               </defend-breaches>
                
                <!-- pull back -->
                <pull-back>
                	<!-- offset from the gate in metres -->
                	<gate-offset>10.0</gate-offset>
                	
                	<!-- per state configuration -->
                	<state-criteria>
                		<!-- stand ground state - will hold position and fight the enemy -->
                		<stand-ground>
                			<!-- stand ground if the percentage of soldiers in the unit in combat is above this -->
                			<combat-percentage>0.0</combat-percentage>
                			
                			<!-- stand ground if the enemy is within this distance - in metres squared -->
                			<nearest-enemy>100.0</nearest-enemy>
                		</stand-ground>
                	</state-criteria>
                </pull-back>
                
                <!-- defense of settlement by artillery -->
                <artillery>
					<!-- minimum offset in metres squared -->
					<minimum-offset>10000.0</minimum-offset>
					
					<!-- maximum offset in metres squared -->
					<maximum-offset>40000.0</maximum-offset>
					
					<!-- placement band begin range -->
					<minimum-range-scale>0.45</minimum-range-scale>
					
					<!-- placement band end range -->
					<maximum-range-scale>0.75</maximum-range-scale>
        			
        			<!-- only issue move orders if we are more than this distance away from the destination -->
        			<destination-proximity>900.0</destination-proximity>
					
					<!-- flag which artillery units are viable for defending a breach -->
					<defend-breaches>
						<catapult>0</catapult>
						<trebuchet>0</trebuchet>
						<ballista>1</ballista>
						<bombard>1</bombard>
						<grand_bombard>1</grand_bombard>
						<huge_bombard>1</huge_bombard>
						<culverin>1</culverin>
						<basilisk>1</basilisk>
						<cannon>1</cannon>
						<mortar>1</mortar>
						<scorpion>1</scorpion>
						<serpentine>1</serpentine>
						<rocket_launcher>1</rocket_launcher>
						<ribault>1</ribault>
						<monster_ribault>1</monster_ribault>
					</defend-breaches>
                </artillery>
        	</tactics>
        </defend-settlement>
        
        <!-- attack crossing objective is used when the river must be crossed at any cost -->
        <attack-crossing>
        	<!-- base priority for this objective -->
        	<priority>100000</priority>
        	
    		<!-- per tactic configuration -->
    		<tactics>
    			<!-- assault group tactic -->
    			<assault>
    				<!-- minimum number of missile units for this task -->
    				<missile-ratio>1.2</missile-ratio>
    				
    				<!-- minimum number of melee units for this task -->
    				<melee-ratio>1.2</melee-ratio>
    				
    				<!-- tick limit on being stalled -->
    				<stall-limit>100</stall-limit>
    				
    				<!-- per phase configuration -->
    				<phases>
    					<!-- phase 1 - moving into formation on near side of crossing -->
    					<phase1>
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
    						
    						<!-- melee offset from crossing for the final location -->
    						<melee-offset>-20.0</melee-offset>
    						
    						<!-- missile offset from crossing for the final location -->
    						<missile-offset>0.0</missile-offset>
    						
    						<!-- artillery offset from crossing for the final location -->
    						<artillery-offset>15.0</artillery-offset>
    						
    						<!-- melee group formation template -->
    						<melee-formation>crossing_assault_force</melee-formation>
    						
    						<!-- missile group formation template -->
    						<missile-formation>crossing_assault_cover</missile-formation>
    					</phase1>
    					
    					<!-- phase 2 - setting up in formation on far side of crossing -->
    					<phase2>
    						<!-- run if closer than this distance (in metres squared) -->
    						<run-threshold>400000</run-threshold>
    						
    						<!-- melee offset from crossing for the final location -->
    						<melee>75.0</melee>
    						
    						<!-- missile offset from crossing for the final location -->
    						<missile>25.0</missile>

    						<!-- configure the conditions for entering this phase -->    						
    						<entry-conditions>
    							<!-- ratio of current to initial melee strength -->
    							<melee-remaining>0.7</melee-remaining>

    							<!-- outshoot ratio between enemy and us. Test: [enemy strength] > [ally strength] * [ratio] -->
    							<outshoot-ratio>1.4</outshoot-ratio>
    						</entry-conditions>
    						
    						<!-- melee group formation template -->
    						<melee-formation>crossing_assault_buffer</melee-formation>
    						
    						<!-- missile group formation template -->
    						<missile-formation>crossing_assault_buffer</missile-formation>
    					</phase2>
    				</phases>
    				
    				<!-- unit suitability values (priorities made higher than sneak tactic so we get the units first) -->
    				<unit-suitability>
    					<!-- all missile units -->
    					<missile>10</missile>
    					
    					<!-- all artillery units -->
    					<artillery>10</artillery>
    					
    					<!-- all melee units -->
    					<melee>8</melee>
    					
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>0</cavalry>
    				</unit-suitability>
    			</assault>
    			
    			<!-- assault support tactic -->
    			<assault-support>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- target ratio of our forces to enemy forces. > 1 means outnumber the enemy, < 1 means enemy outnumbers us -->
    				<strength-ratio>2.0</strength-ratio>
    				
    				<!-- how much do enemy forces in the neighbouring zone contribute -->
    				<neighbour-contribution>0.0</neighbour-contribution>
    				
    				<!-- stand off distance when not needing to engage enemy -->
    				<standoff-distance>100.0</standoff-distance>
    			</assault-support>
    			
    			<!-- sneak attack tactic -->
    			<sneak-attack>
    				<!-- minimum number of units for this task -->
    				<minimum-units>1</minimum-units>
    				
    				<!-- unit suitability values -->
    				<unit-suitability>
    					<!-- all cavalry units (elephants, horses etc) -->
    					<cavalry>3</cavalry>
    				</unit-suitability>

    				<!-- if less than this distance to objective then run (distance in metres^2) -->
    				<run-threshold>40000</run-threshold>
    				
    				<!-- if the crossing is the same as the one being assaulted, halt at this distance from the crossing -->
    				<standoff-offset>150.0</standoff-offset>
    				
    				<!-- when crossing the river head to a location this distance beyond the end point -->
    				<crossing-offset>50.0</crossing-offset>    	
    				
    				<!-- head for this offset from the enemy -->
    				<enemy-offset>100.0</enemy-offset>			
    				
    				<!-- parameters for determining the suitability of a crossing for use in a sneak attack -->
    				<crossing-suitability>
    					<!-- enemy force strength / sneak force strength must be below this value to be suitable -->
    					<strength-ratio>0.25</strength-ratio>
    					
    					<!-- amount of benefit the strength ratio yields -->
    					<strength-contribution>10.0</strength-contribution>
    					
    					<!-- amount of benefit the distance ratio (tested vs ideal) yiels -->
    					<distance-contribution>5.0</distance-contribution>
    				</crossing-suitability>
    			</sneak-attack>
    		</tactics>
        </attack-crossing>
        
        <!-- objective for defending the crossing at all costs. does not attempt to cross -->
        <defend-crossing>
			<detachment>
			<!-- how weak the enemy must be before the Ai returns to blocking the crossing -->
			<enemy-missile-to-friendly-strength-ratio>0.1</enemy-missile-to-friendly-strength-ratio>
			<!-- percentage of troops killed in 4 seconds by missile units to cause Ai to pull back -->
			<missile-death-threshold>0.02</missile-death-threshold>
			<!-- minimum 10ths of seconds between changing tactics -->
			<min-time-between-tactic-change>200</min-time-between-tactic-change>
			<!-- ratio of enemy melee strength crossing the river to friendly melee strength to be considered a threat -->
			<melee-threat-threshold>0.2</melee-threat-threshold>
			<!-- percentage of starting missile strength the enemy must be at to return to blocking the crossing from holding back -->
			<enemy-missile-strength-percent>0.6</enemy-missile-strength-percent>
			</detachment>
         	<tactics>
         	    <!-- if we are closer than this distance (in metres squared) then run -->
         		<run-threshold>40000.0</run-threshold>
         		<block>
         		</block>
         		<defend-distance>
         		    <!-- bias between max range and average range -->
         			<range-bias>0.5</range-bias>         			
         			<!-- offset from the crossing for the formation -->
         			<standoff-distance>25.0</standoff-distance>
         			<!-- max distance units will move away from the crossing -->
         			<max-retreat-distance>75.0</max-retreat-distance>
         		</defend-distance>
        	</tactics>
        </defend-crossing>
        <battle-analyser>
			<!-- ratio of friendly to enemy strength to be considered more powerful -->
			<friendly-to-enemy-strength-ratio>1.0</friendly-to-enemy-strength-ratio>
			<!-- ratio of friendly to enemy melee strength to be considered overwhelmingly powerful -->
			<enemy-melee-strength-multiplier>1.1</enemy-melee-strength-multiplier>
			<!-- ratio of friendly strength to enemy melee strength to force attack -->
			<friendly-melee-strength-divisor>0.9</friendly-melee-strength-divisor>
			<!-- ratio of enemy to friendly ranged strength to be considered overwhelmingly powerful -->
			<friendly-ranged-strength-multiplier>3.0</friendly-ranged-strength-multiplier>
			<!-- ratio of friendly strength to enemy ranged strength to force attack -->
			<friendly-ranged-strength-divisor>5.0</friendly-ranged-strength-divisor>
			<!-- distance behind the defensive line the enemy must reach to be considered to have broken through -->
			<enemy-position-buffer-distance>100</enemy-position-buffer-distance>
        </battle-analyser>
    </gta>
</config>

<variations>
</variations>
